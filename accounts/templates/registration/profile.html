{%extends 'base.html'%}
{%load static%}
{%load humanize%}
{%block title%}
	Profile
{%endblock title%}


{%block styles%}
	<style type="text/css">
  		section { padding-bottom: 600px; }
	</style>
	<link rel="stylesheet" type="text/css" href="{%static 'css/profile/_profile.css'%}">
{%endblock styles%}

{%block content%}
	<section>
		<div class="container">
			<div class="perfil row">

				<article class="col-sm-12 col-md-4 text-center">
					<div class="container_userData">
						<h2>Bienvenido a tu perfil</h2>
						<figure class="containder_userImg">
							<img class="img-responsive"  src="{%if request.user.client.photo%}{{request.user.client.photo.url}}{%else%}{%static '/img/user.jpg'%}{%endif%}" alt="Foto de Perfil" >
						</figure>
						<h3>{{request.user.username|upper}}</h3>
						<hr class="hrPerfil">
						<strong>{{request.user.email}}</strong>
					</div>
				</article>

				<article class="col-sm-12 col-md-8">
					<ul class="nav nav-tabs" role="tablist">
						<li role="presentation" class="active">
							<a href="#garage" aria-controls="garage" role="tab" data-toggle="tab">
								<i class="fa fa-car">Mi garage</i>
							</a>
						</li>
						<li role="presentation">
							<a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">
								<i class="fa fa-user">Datos de Perfil</i>
							</a>
						</li>
						<li role="presentation">
							<a href="#pagos" aria-controls="pagos" role="tab" data-toggle="tab">
								<i class="fa fa-dollar">Detalle de Pagos</i>
							</a>
						</li>
					</ul>

					<div class="tab-content">
						<div role="tabpanel" class="tab-pane fade in active" id="garage">
							<div class="panel-group" id="acordion" role="tablist" aria-multiselectable="true">	
								<div class="panel panel-default">
								{%for ga in garage%}
									
									<div class="panel-heading" role="tab" id="headingOne{{forloop.counter}}">
										<h4 class="panel-title">
											<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne{{forloop.counter}}" aria-expanded="true" aria-controls="collapseOne{{forloop.counter}}">
												<strong>{{ga.user_vehicle.vehicle.name}}</strong>
											</a>
										</h4>
									</div>

									<div id="collapseOne{{forloop.counter}}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne{{forloop.counter}}">
										<div class="panel-body">
											<div class="col-sm-12 col-md-6">
												<ul class="list-group">
	                                                <li class="list-group-item"><strong>{{ga.user_vehicle.vehicle.trademark.name}}</strong></li>
	                                                <li class="list-group-item">{{ga.user_vehicle.version}}</li>
	                                                <li class="list-group-item">
														{%if ga.monthly_payment == 48%}
															Primer mes de {{ga.user_vehicle.fee_mounth_48|floatformat:2|intcomma}}
														{%else%}
															Primer mes de {{ga.user_vehicle.fee_mounth_60|floatformat:2|intcomma}}
														{%endif%}
	                                                </li>
	                                                <li class="list-group-item">
														Inscripción {{ga.user_vehicle.fee_inscription|floatformat:2|intcomma}}
	                                                </li>
                                            	</ul>
                                            	<div class="col-sm-offset-6 col-md-offset-4">
                                            		<img src="{{ga.user_vehicle.vehicle.trademark.logo.url}}" style="width: 20%" alt="" class="img-responsive img-circle">
                                            	</div>
											</div>
											<figure class="col-sm-12 col-md-6">
												<img class="img-responsive" src="{{ga.user_vehicle.img_v1.url}}" alt="Volkswagen"> 
											</figure>
											<div class="col-md-12 text-center">
                                            	{%if ga.status%}
                                            		<a class="btn btn-success" href="#" disabled="disabled">
                                            			Este auto esta en Financiamiento
                                            		</a>
                                            	{%else%}
                                            		<a class="btn btn-primary" href="#">
                                            			Empieza a Financiarlo
                                            		</a>
                                            		<form>
                                            			<input class="btn btn-danger" type="submit" name="eliminar" value="Eliminar de tu Garage">
                                            			<input type="hidden" name="id_version_garage" >
                                            		</form>
                                            	{%endif%}
                                        	</div>
										</div>
									</div>
									
									{%empty%}
									<h4>Aun no agregas ningun Auto a tu garage</h4>
									<h4><a href="{% url 'catalogo:catalog'%}">Busca el mejor auto para ti aquí...</a></h4>
									{%endfor%}
								</div>
							</div>
						</div>
						<div role="tabpanel" class="tab-pane" id="profile">
							<h5>Mi perfil</h5>
							<div class="progress col-sm-12 col-md-12" style="margin-top:2%;">
		                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
		                            	60%
		                        </div>
		                    </div>
		                    <div class="col-md-12">
		                    	<form role="form" action="." method="post">
		                    		<div class="form-group">
										{%csrf_token%}
										{{userform.as_p}}
										{{profile.as_p}}
										<input class="btn btn-primary" type="Submit" name="Guardar" placeholder="Guardar Tu Informacion">
		                    		</div>
								</form>
		                    </div>
						</div>
						<div role="tabpanel" class="tab-pane" id="pagos">
								Aún no cuentas con ningun pagó
						</div>
					</div>
				</article>

			</div>
		</div> <!--container-->
	</section>
{%endblock content%}